#!/usr/bin/env bash
# read-where - convert lambdabot's @where db as TSV on stdin to link records

grep -E 'https?:' - \
    | perl -p -e 's/"/""/g' \
    | perl -p -e 's/(.*?)\t<?(https?:.*?)([>, ] *(.*)|$)/$2, $1, lambdabot, "$4"/' \
    | perl -p -e 's/(.*?)\t([^<]+?)<?(https?:.*?)([>, ] *(.*)|$)/$3, $1, lambdabot, "$2 ... $5"/'
